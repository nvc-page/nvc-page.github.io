function doGet(a){var b=a.parameter.action,c=SpreadsheetApp.openByUrl("https://docs.google.com/spreadsheets/d/1wMt6ndm_qvE_bp-vGEhJxdgo0_-Wq4W-og_C0qKjmbA/edit#gid=0"),d=c.getSheetByName("Sheet1");return"insert"==b?insert_value(a,d):"read"==b?read_value(a,c):"update"==b?update_value(a,d):"delete"==b?delete_value(a,d):void 0}function insert_value(a,b){for(var c,e=a.parameter.project_name,f=a.parameter.name,g=a.parameter.content,h=1,j=b.getLastRow(),k=1;k<=j;k++)if(c=b.getRange(k,2).getValue(),c==e){h=0;var l="project_name already exist.."}if(1==h)var m=new Date,d=m.toLocaleString(),n=b.appendRow([d,e,f,g]),l="Insertion successful";return l=JSON.stringify({result:l}),ContentService.createTextOutput(a.parameter.callback+"("+l+")").setMimeType(ContentService.MimeType.JAVASCRIPT)}function read_value(a,b){var c=ContentService.createTextOutput(),d={};d.records=readData_(b,"sheet1");var e=a.parameters.callback;return void 0===e?c.setContent(JSON.stringify(d)):c.setContent(e+"("+JSON.stringify(d)+")"),c.setMimeType(ContentService.MimeType.JAVASCRIPT),c}function readData_(a,b,c){"undefined"==typeof c&&(c=getHeaderRow_(a,b),c=c.map(function(a){return a.replace(/\s+/g,"_")}));for(var d=getDataRows_(a,b),e=[],f=0,g=d.length;f<g;f++){var h=d[f],i={};for(var j in c)i[c[j]]=h[j];e.push(i)}return e}function getDataRows_(a,b){var c=a.getSheetByName(b);return c.getRange(2,1,c.getLastRow()-1,c.getLastColumn()).getValues()}function getHeaderRow_(a,b){var c=a.getSheetByName(b);return c.getRange(1,1,1,c.getLastColumn()).getValues()[0]}function update_value(a,b){for(var c,d=ContentService.createTextOutput(),e=a.parameter.project_name,f=0,g=a.parameter.name,h=b.getLastRow(),j=1;j<=h;j++)if(c=b.getRange(j,2).getValue(),c==e){b.getRange(j,3).setValue(g);var k="value updated successfully";f=1}if(0==f)var k="project_name not found";return k=JSON.stringify({result:k}),ContentService.createTextOutput(a.parameter.callback+"("+k+")").setMimeType(ContentService.MimeType.JAVASCRIPT)}function delete_value(a,b){for(var c,d=ContentService.createTextOutput(),e=a.parameter.project_name,f=a.parameter.name,g=0,h=b.getLastRow(),j=1;j<=h;j++)if(c=b.getRange(j,2).getValue(),c==e){b.deleteRow(j);var k="value deleted successfully";g=1}if(0==g)var k="project_name not found";return k=JSON.stringify({result:k}),ContentService.createTextOutput(a.parameter.callback+"("+k+")").setMimeType(ContentService.MimeType.JAVASCRIPT)}
